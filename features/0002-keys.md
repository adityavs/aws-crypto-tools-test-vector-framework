
|           |                                               |
|:----------|:----------------------------------------------|
|__Feature__|Keys Manifest                                  |
|__Version__|1                                              |
|__Created__|2018-06-25                                     |
|__Updated__|ISO-8601 date feature was most recently updated|

## Summary

The keys manifest defines raw key materials for use in tests defined in other manifests.

## Out of Scope

This is not a definition of how these keys should be used by any given tests.

## Motivation

Defining keys separately from individual test vectors enables us to reuse test key materials 
across many test manifests. This is useful when defining many tests to avoid duplicating 
effort and space generating and saving keys for each test. It also allows for single-source definition 
of specific keys that might have specific behaviors. This could include special key materials 
such as null keys or special key references such as identifying a specific AWS KMS customer master 
key (CMK).

## Security Implications

All keys defined in this manifest are by definition public knowledge. They must be treated as 
such.

## Guide-level Explanation

Keys are defined in a JSON manifest file. Each key entry defines a key material, an encoding, 
and an optional line separator. These are used to load each key for use elsewhere.

## Reference-level Explanation

### Contents

#### manifest

Map identifying this manifest.

* `type` : Identifies this manifest as a meta-manifest.
    * Must be `keys`
* `version` : Identifies the version of this document that describes the contents of the manifest.

### keys

Map structure mapping key names to key descriptions.

#### User Defined Keys

User Defined keys are stored as JSON objects with the following attributes:

* `algorithm` : Defines the algorithm type
* `type` : Defines the key type
   * Allowed Values
      * `symmetric`
      * `private`
      * `public`
* `bits` : Defines the key length in bits
* `encoding` : Encoding used to store key
   * Allowed Values
      * `raw` : Key material bytes are not additionally encoded.
      * `base64` : Key material bytes are encoded using base64.
      * `pem` : Key material bytes are encoded using PEM format.
* `line-separator` : Line separator with which to join multi-line keys (optional) (default: "")
* `material` : List containing elements which make up key material. These elements are joined 
  using `line-separator` to assemble the complete key material.

#### KMS

Keys can also reference an AWS KMS CMK. They should contain the following attributes.

* `type`: Identifies the key type
   * Must be `aws-kms`
* `key-id`: KMS CMK ID

### Example

```json
{
    "manifest": {
        "type": "keys",
        "version": 1
    },
    "keys": {
        "aes-128": {
            "algorithm": "aes",
            "type": "symmetric",
            "bits": 128,
            "encoding": "raw",
            "material": ["1234567890123456"]
        },
        "aes-192": {
            "algorithm": "aes",
            "type": "symmetric",
            "bits": 192,
            "encoding": "raw",
            "material": ["123456789012345678901234"]
        },
        "aes-256": {
            "algorithm": "aes",
            "type": "symmetric",
            "bits": 256,
            "encoding": "base64",
            "material": ["yar+8MbgZemJ9j41RjNpiYVCblujSNkYTIeKC/EEADc="]
        },
        "rsa-2048": {
            "algorithm": "rsa",
            "type": "private",
            "bits": 2048,
            "encoding": "pem",
            "line-separator": "\n", 
            "material": [
                "-----BEGIN RSA PRIVATE KEY-----",
                "MIIEowIBAAKCAQEAo8uCyhiO4JUGZV+rtNq5DBA9Lm4xkw5kTA3v6EPybs8bVXL2",
                "ZE6jkbo+xT4Jg/bKzUpnp1fE+T1ruGPtsPdoEmhY/P64LDNIs3sRq5U4QV9IETU1",
                "vIcbNNkgGhRjV8J87YNY0tV0H7tuWuZRpqnS+gjV6V9lUMkbvjMCc5IBqQc3heut",
                "/+fH4JwpGlGxOVXI8QAapnSy1XpCr3+PT29kydVJnIMuAoFrurojRpOQbOuVvhtA",
                "gARhst1Ji4nfROGYkj6eZhvkz2Bkud4/+3lGvVU5LO1vD8oY7WoGtpin3h50VcWe",
                "aBT4kejx4s9/G9C4R24lTH09J9HO2UUsuCqZYQIDAQABAoIBAQCfC90bCk+qaWqF",
                "gymC+qOWwCn4bM28gswHQb1D5r6AtKBRD8mKywVvWs7azguFVV3Fi8sspkBA2FBC",
                "At5p6ULoJOTL/TauzLl6djVJTCMM701WUDm2r+ZOIctXJ5bzP4n5Q4I7b0NMEL7u",
                "ixib4elYGr5D1vrVQAKtZHCr8gmkqyx8Mz7wkJepzBP9EeVzETCHsmiQDd5WYlO1",
                "C2IQYgw6MJzgM4entJ0V/GPytkodblGY95ORVK7ZhyNtda+r5BZ6/jeMW+hA3VoK",
                "tHSWjHt06ueVCCieZIATmYzBNt+zEz5UA2l7ksg3eWfVORJQS7a6Ef4VvbJLM9Ca",
                "m1kdsjelAoGBANKgvRf39i3bSuvm5VoyJuqinSb/23IH3Zo7XOZ5G164vh49E9Cq",
                "dOXXVxox74ppj/kbGUoOk+AvaB48zzfzNvac0a7lRHExykPH2kVrI/NwH/1OcT/x",
                "2e2DnFYocXcb4gbdZQ+m6X3zkxOYcONRzPVW1uMrFTWHcJveMUm4PGx7AoGBAMcU",
                "IRvrT6ye5se0s27gHnPweV+3xjsNtXZcK82N7duXyHmNjxrwOAv0SOhUmTkRXArM",
                "6aN5D8vyZBSWma2TgUKwpQYFTI+4Sp7sdkkyojGAEixJ+c5TZJNxZFrUe0FwAoic",
                "c2kb7ntaiEj5G+qHvykJJro5hy6uLnjiMVbAiJDTAoGAKb67241EmHAXGEwp9sdr",
                "2SMjnIAnQSF39UKAthkYqJxa6elXDQtLoeYdGE7/V+J2K3wIdhoPiuY6b4vD0iX9",
                "JcGM+WntN7YTjX2FsC588JmvbWfnoDHR7HYiPR1E58N597xXdFOzgUgORVr4PMWQ",
                "pqtwaZO3X2WZlvrhr+e46hMCgYBfdIdrm6jYXFjL6RkgUNZJQUTxYGzsY+ZemlNm",
                "fGdQo7a8kePMRuKY2MkcnXPaqTg49YgRmjq4z8CtHokRcWjJUWnPOTs8rmEZUshk",
                "0KJ0mbQdCFt/Uv0mtXgpFTkEZ3DPkDTGcV4oR4CRfOCl0/EU/A5VvL/U4i/mRo7h",
                "ye+xgQKBgD58b+9z+PR5LAJm1tZHIwb4tnyczP28PzwknxFd2qylR4ZNgvAUqGtU",
                "xvpUDpzMioz6zUH9YV43YNtt+5Xnzkqj+u9Mr27/H2v9XPwORGfwQ5XPwRJz/2oC",
                "EnPmP1SZoY9lXKUpQXHXSpDZ2rE2Klt3RHMUMHt8Zpy36E8Vwx8o",
                "-----END RSA PRIVATE KEY-----"
            ]
        },
        "us-west-2-decryptable": {
            "type": "aws-kms",
            "key-id": "arn:aws:kms:us-west-2:658956600833:alias/EncryptDecrypt"
        },
        "us-west-2-encrypt-only": {
            "type": "aws-kms",
            "key-id": "arn:aws:kms:us-west-2:658956600833:alias/EncryptOnly"
        }
    }
}
```
